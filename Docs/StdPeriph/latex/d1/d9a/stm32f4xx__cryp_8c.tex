\hypertarget{stm32f4xx__cryp_8c}{\section{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.1.0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-cryp.c File Reference}
\label{stm32f4xx__cryp_8c}\index{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.\-1.\-0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-cryp.\-c@{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.\-1.\-0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-cryp.\-c}}
}


This file provides firmware functions to manage the following functionalities of the Cryptographic processor (C\-R\-Y\-P) peripheral\-:  


{\ttfamily \#include \char`\"{}stm32f4xx\-\_\-cryp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stm32f4xx\-\_\-rcc.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group___c_r_y_p_ga890221cb651a3f30f6d1bca0d9b0e13d}{\#define {\bfseries F\-L\-A\-G\-\_\-\-M\-A\-S\-K}~((uint8\-\_\-t)0x20)}\label{group___c_r_y_p_ga890221cb651a3f30f6d1bca0d9b0e13d}

\item 
\hypertarget{group___c_r_y_p_ga85fda3522e69a1bf85f7dcd97b6023a1}{\#define {\bfseries M\-A\-X\-\_\-\-T\-I\-M\-E\-O\-U\-T}~((uint16\-\_\-t)0x\-F\-F\-F\-F)}\label{group___c_r_y_p_ga85fda3522e69a1bf85f7dcd97b6023a1}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group___c_r_y_p___group1_gae19e54c9910b697e38f6c7577704ffae}{C\-R\-Y\-P\-\_\-\-De\-Init} (void)
\begin{DoxyCompactList}\small\item\em Deinitializes the C\-R\-Y\-P peripheral registers to their default reset values. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_ga7b72c458d95581ab0a36be3e017fcf02}{C\-R\-Y\-P\-\_\-\-Init} (\hyperlink{struct_c_r_y_p___init_type_def}{C\-R\-Y\-P\-\_\-\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Initializes the C\-R\-Y\-P peripheral according to the specified parameters in the C\-R\-Y\-P\-\_\-\-Init\-Struct. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_ga8fb8ec75fe72d55046c8220825dfe41e}{C\-R\-Y\-P\-\_\-\-Struct\-Init} (\hyperlink{struct_c_r_y_p___init_type_def}{C\-R\-Y\-P\-\_\-\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Fills each C\-R\-Y\-P\-\_\-\-Init\-Struct member with its default value. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_gad4baa3865415215cae07c9fbfa131cb9}{C\-R\-Y\-P\-\_\-\-Key\-Init} (\hyperlink{struct_c_r_y_p___key_init_type_def}{C\-R\-Y\-P\-\_\-\-Key\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-Key\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Initializes the C\-R\-Y\-P Keys according to the specified parameters in the C\-R\-Y\-P\-\_\-\-Key\-Init\-Struct. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_gaeecd86b00d0d0137d97b06108789bcb2}{C\-R\-Y\-P\-\_\-\-Key\-Struct\-Init} (\hyperlink{struct_c_r_y_p___key_init_type_def}{C\-R\-Y\-P\-\_\-\-Key\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-Key\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Fills each C\-R\-Y\-P\-\_\-\-Key\-Init\-Struct member with its default value. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_ga133964b50a07db3a32864308f6355a8b}{C\-R\-Y\-P\-\_\-\-I\-V\-Init} (\hyperlink{struct_c_r_y_p___i_v_init_type_def}{C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Initializes the C\-R\-Y\-P Initialization Vectors(\-I\-V) according to the specified parameters in the C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Struct. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_ga58899074e08bbd65f2ed304cf0f42987}{C\-R\-Y\-P\-\_\-\-I\-V\-Struct\-Init} (\hyperlink{struct_c_r_y_p___i_v_init_type_def}{C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Fills each C\-R\-Y\-P\-\_\-\-I\-V\-Init\-Struct member with its default value. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_ga23ada9d9464e1362299d7612a1409a57}{C\-R\-Y\-P\-\_\-\-F\-I\-F\-O\-Flush} (void)
\begin{DoxyCompactList}\small\item\em Flushes the I\-N and O\-U\-T F\-I\-F\-Os (that is read and write pointers of the F\-I\-F\-Os are reset) \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group1_gad39ccd9b1f2e088e3a227d7a1c410d7c}{C\-R\-Y\-P\-\_\-\-Cmd} (Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the C\-R\-Y\-P peripheral. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group2_ga16dc76244318d464357ee6ff208bf9a4}{C\-R\-Y\-P\-\_\-\-Data\-In} (uint32\-\_\-t Data)
\begin{DoxyCompactList}\small\item\em Writes data in the Data Input register (D\-I\-N). \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{group___c_r_y_p___group2_gacbe5fcf4c7e4919192376fa615588b54}{C\-R\-Y\-P\-\_\-\-Data\-Out} (void)
\begin{DoxyCompactList}\small\item\em Returns the last data entered into the output F\-I\-F\-O. \end{DoxyCompactList}\item 
Error\-Status \hyperlink{group___c_r_y_p___group3_ga41a14be7fa43d500e7c94cce40910ea8}{C\-R\-Y\-P\-\_\-\-Save\-Context} (\hyperlink{struct_c_r_y_p___context}{C\-R\-Y\-P\-\_\-\-Context} $\ast$C\-R\-Y\-P\-\_\-\-Context\-Save, \hyperlink{struct_c_r_y_p___key_init_type_def}{C\-R\-Y\-P\-\_\-\-Key\-Init\-Type\-Def} $\ast$C\-R\-Y\-P\-\_\-\-Key\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Saves the C\-R\-Y\-P peripheral Context. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group3_gaf2986782fa66ea95b2a389595e17e0e5}{C\-R\-Y\-P\-\_\-\-Restore\-Context} (\hyperlink{struct_c_r_y_p___context}{C\-R\-Y\-P\-\_\-\-Context} $\ast$C\-R\-Y\-P\-\_\-\-Context\-Restore)
\begin{DoxyCompactList}\small\item\em Restores the C\-R\-Y\-P peripheral Context. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group4_ga111d0ec56facb27f8367ce6a33869115}{C\-R\-Y\-P\-\_\-\-D\-M\-A\-Cmd} (uint8\-\_\-t C\-R\-Y\-P\-\_\-\-D\-M\-A\-Req, Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the C\-R\-Y\-P D\-M\-A interface. \end{DoxyCompactList}\item 
void \hyperlink{group___c_r_y_p___group5_gafbf5ee5f2c3ae4404149a994e15b33d8}{C\-R\-Y\-P\-\_\-\-I\-T\-Config} (uint8\-\_\-t C\-R\-Y\-P\-\_\-\-I\-T, Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the specified C\-R\-Y\-P interrupts. \end{DoxyCompactList}\item 
I\-T\-Status \hyperlink{group___c_r_y_p___group5_ga00a48b748ed127fa517cacec9dbf18f4}{C\-R\-Y\-P\-\_\-\-Get\-I\-T\-Status} (uint8\-\_\-t C\-R\-Y\-P\-\_\-\-I\-T)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\-R\-Y\-P interrupt has occurred or not. \end{DoxyCompactList}\item 
Flag\-Status \hyperlink{group___c_r_y_p___group5_ga993d568b626a74b2973d4a6848a681f6}{C\-R\-Y\-P\-\_\-\-Get\-Flag\-Status} (uint8\-\_\-t C\-R\-Y\-P\-\_\-\-F\-L\-A\-G)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\-R\-Y\-P flag is set or not. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file provides firmware functions to manage the following functionalities of the Cryptographic processor (C\-R\-Y\-P) peripheral\-: \begin{DoxyAuthor}{Author}
M\-C\-D Application Team 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
V1.\-0.\-0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
30-\/\-September-\/2011
\begin{DoxyItemize}
\item Initialization and Configuration functions
\item Data treatment functions
\item Context swapping functions
\item D\-M\-A interface function
\item Interrupts and flags management
\end{DoxyItemize}
\end{DoxyDate}
\begin{DoxyVerb}*                               
*          ===================================================================      
*                                 How to use this driver
*          =================================================================== 
*          1. Enable the CRYP controller clock using 
*              RCC_AHB2PeriphClockCmd(RCC_AHB2Periph_CRYP, ENABLE); function.
*
*          2. Initialise the CRYP using CRYP_Init(), CRYP_KeyInit() and if 
*             needed CRYP_IVInit(). 
*
*          3. Flush the IN and OUT FIFOs by using CRYP_FIFOFlush() function.
*
*          4. Enable the CRYP controller using the CRYP_Cmd() function. 
*
*          5. If using DMA for Data input and output transfer, 
*             Activate the needed DMA Requests using CRYP_DMACmd() function 

*          6. If DMA is not used for data transfer, use CRYP_DataIn() and 
*             CRYP_DataOut() functions to enter data to IN FIFO and get result
*             from OUT FIFO.
*
*          7. To control CRYP events you can use one of the following 
*              two methods:
*               - Check on CRYP flags using the CRYP_GetFlagStatus() function.  
*               - Use CRYP interrupts through the function CRYP_ITConfig() at 
*                 initialization phase and CRYP_GetITStatus() function into 
*                 interrupt routines in processing phase.
*       
*          8. Save and restore Cryptographic processor context using  
*             CRYP_SaveContext() and CRYP_RestoreContext() functions.     
*
*
*          ===================================================================  
*                Procedure to perform an encryption or a decryption
*          ===================================================================  
*
*      Initialization
*      ===============  
*     1. Initialize the peripheral using CRYP_Init(), CRYP_KeyInit() and 
*        CRYP_IVInit functions:
*        - Configure the key size (128-, 192- or 256-bit, in the AES only) 
*        - Enter the symmetric key 
*        - Configure the data type
*        - In case of decryption in AES-ECB or AES-CBC, you must prepare 
*          the key: configure the key preparation mode. Then Enable the CRYP 
*          peripheral using CRYP_Cmd() function: the BUSY flag is set. 
*          Wait until BUSY flag is reset : the key is prepared for decryption
*       - Configure the algorithm and chaining (the DES/TDES in ECB/CBC, the 
*          AES in ECB/CBC/CTR) 
*       - Configure the direction (encryption/decryption).
*       - Write the initialization vectors (in CBC or CTR modes only)
*
*    2. Flush the IN and OUT FIFOs using the CRYP_FIFOFlush() function
*
*
*    Basic Processing mode (polling mode) 
*    ====================================  
*    1. Enable the cryptographic processor using CRYP_Cmd() function.
*
*    2. Write the first blocks in the input FIFO (2 to 8 words) using 
*       CRYP_DataIn() function.
*
*    3. Repeat the following sequence until the complete message has been 
*       processed:
*
*       a) Wait for flag CRYP_FLAG_OFNE occurs (using CRYP_GetFlagStatus() 
*          function), then read the OUT-FIFO using CRYP_DataOut() function
*          (1 block or until the FIFO is empty)
*
*       b) Wait for flag CRYP_FLAG_IFNF occurs, (using CRYP_GetFlagStatus() 
*          function then write the IN FIFO using CRYP_DataIn() function 
*          (1 block or until the FIFO is full)
*
*    4. At the end of the processing, CRYP_FLAG_BUSY flag will be reset and 
*        both FIFOs are empty (CRYP_FLAG_IFEM is set and CRYP_FLAG_OFNE is 
*        reset). You can disable the peripheral using CRYP_Cmd() function.
*
*    Interrupts Processing mode 
*    ===========================
*    In this mode, Processing is done when the data are transferred by the 
*    CPU during interrupts.
*
*    1. Enable the interrupts CRYP_IT_INI and CRYP_IT_OUTI using 
*       CRYP_ITConfig() function.
*
*    2. Enable the cryptographic processor using CRYP_Cmd() function.
*
*    3. In the CRYP_IT_INI interrupt handler : load the input message into the 
*       IN FIFO using CRYP_DataIn() function . You can load 2 or 4 words at a 
*       time, or load data until the IN FIFO is full. When the last word of
*       the message has been entered into the IN FIFO, disable the CRYP_IT_INI 
*       interrupt (using CRYP_ITConfig() function).
*
*    4. In the CRYP_IT_OUTI interrupt handler : read the output message from 
*       the OUT FIFO using CRYP_DataOut() function. You can read 1 block (2 or 
*       4 words) at a time or read data until the FIFO is empty.
*       When the last word has been read, INIM=0, BUSY=0 and both FIFOs are 
*       empty (CRYP_FLAG_IFEM is set and CRYP_FLAG_OFNE is reset). 
*       You can disable the CRYP_IT_OUTI interrupt (using CRYP_ITConfig() 
*       function) and you can disable the peripheral using CRYP_Cmd() function.
*
*    DMA Processing mode 
*    ====================
*    In this mode, Processing is done when the DMA is used to transfer the 
*    data from/to the memory.
*
*    1. Configure the DMA controller to transfer the input data from the 
*       memory using DMA_Init() function. 
*       The transfer length is the length of the message. 
*       As message padding is not managed by the peripheral, the message 
*       length must be an entire number of blocks. The data are transferred 
*       in burst mode. The burst length is 4 words in the AES and 2 or 4 
*       words in the DES/TDES. The DMA should be configured to set an 
*       interrupt on transfer completion of the output data to indicate that 
*       the processing is finished. 
*       Refer to DMA peripheral driver for more details.  
*
*    2. Enable the cryptographic processor using CRYP_Cmd() function. 
*       Enable the DMA requests CRYP_DMAReq_DataIN and CRYP_DMAReq_DataOUT 
*       using CRYP_DMACmd() function.
*
*    3. All the transfers and processing are managed by the DMA and the 
*       cryptographic processor. The DMA transfer complete interrupt indicates 
*       that the processing is complete. Both FIFOs are normally empty and 
*       CRYP_FLAG_BUSY flag is reset.
*
*  \end{DoxyVerb}


\begin{DoxyAttention}{Attention}

\end{DoxyAttention}
T\-H\-E P\-R\-E\-S\-E\-N\-T F\-I\-R\-M\-W\-A\-R\-E W\-H\-I\-C\-H I\-S F\-O\-R G\-U\-I\-D\-A\-N\-C\-E O\-N\-L\-Y A\-I\-M\-S A\-T P\-R\-O\-V\-I\-D\-I\-N\-G C\-U\-S\-T\-O\-M\-E\-R\-S W\-I\-T\-H C\-O\-D\-I\-N\-G I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N R\-E\-G\-A\-R\-D\-I\-N\-G T\-H\-E\-I\-R P\-R\-O\-D\-U\-C\-T\-S I\-N O\-R\-D\-E\-R F\-O\-R T\-H\-E\-M T\-O S\-A\-V\-E T\-I\-M\-E. A\-S A R\-E\-S\-U\-L\-T, S\-T\-M\-I\-C\-R\-O\-E\-L\-E\-C\-T\-R\-O\-N\-I\-C\-S S\-H\-A\-L\-L N\-O\-T B\-E H\-E\-L\-D L\-I\-A\-B\-L\-E F\-O\-R A\-N\-Y D\-I\-R\-E\-C\-T, I\-N\-D\-I\-R\-E\-C\-T O\-R C\-O\-N\-S\-E\-Q\-U\-E\-N\-T\-I\-A\-L D\-A\-M\-A\-G\-E\-S W\-I\-T\-H R\-E\-S\-P\-E\-C\-T T\-O A\-N\-Y C\-L\-A\-I\-M\-S A\-R\-I\-S\-I\-N\-G F\-R\-O\-M T\-H\-E C\-O\-N\-T\-E\-N\-T O\-F S\-U\-C\-H F\-I\-R\-M\-W\-A\-R\-E A\-N\-D/\-O\-R T\-H\-E U\-S\-E M\-A\-D\-E B\-Y C\-U\-S\-T\-O\-M\-E\-R\-S O\-F T\-H\-E C\-O\-D\-I\-N\-G I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N C\-O\-N\-T\-A\-I\-N\-E\-D H\-E\-R\-E\-I\-N I\-N C\-O\-N\-N\-E\-C\-T\-I\-O\-N W\-I\-T\-H T\-H\-E\-I\-R P\-R\-O\-D\-U\-C\-T\-S.

\subsubsection*{\begin{center}\copyright C\-O\-P\-Y\-R\-I\-G\-H\-T 2011 S\-T\-Microelectronics\end{center} }

Definition in file \hyperlink{stm32f4xx__cryp_8c_source}{stm32f4xx\-\_\-cryp.\-c}.

