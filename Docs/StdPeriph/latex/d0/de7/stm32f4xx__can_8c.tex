\hypertarget{stm32f4xx__can_8c}{\section{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.1.0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-can.c File Reference}
\label{stm32f4xx__can_8c}\index{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.\-1.\-0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-can.\-c@{E\-:/\-Workspaces/\-Google\-\_\-\-Drive/\-Google Drive/\-Workshop/arm/stsw-\/stm32068/\-S\-T\-M32\-F4-\/\-Discovery\-\_\-\-F\-W\-\_\-\-V1.\-1.\-0/\-Libraries/\-S\-T\-M32\-F4xx\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f4xx\-\_\-can.\-c}}
}


This file provides firmware functions to manage the following functionalities of the Controller area network (C\-A\-N) peripheral\-:  


{\ttfamily \#include \char`\"{}stm32f4xx\-\_\-can.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stm32f4xx\-\_\-rcc.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group___c_a_n_ga1ded3736beb63c49281f2983fc68c36d}{\#define {\bfseries M\-C\-R\-\_\-\-D\-B\-F}~((uint32\-\_\-t)0x00010000) /$\ast$ software master reset $\ast$/}\label{group___c_a_n_ga1ded3736beb63c49281f2983fc68c36d}

\item 
\hypertarget{group___c_a_n_gabeb6db5ba5c01da5084ec1605f868e18}{\#define {\bfseries T\-M\-I\-Dx\-R\-\_\-\-T\-X\-R\-Q}~((uint32\-\_\-t)0x00000001) /$\ast$ Transmit mailbox request $\ast$/}\label{group___c_a_n_gabeb6db5ba5c01da5084ec1605f868e18}

\item 
\hypertarget{group___c_a_n_ga6125d0273c466e402db1a8f5bf888857}{\#define {\bfseries F\-M\-R\-\_\-\-F\-I\-N\-I\-T}~((uint32\-\_\-t)0x00000001) /$\ast$ Filter init mode $\ast$/}\label{group___c_a_n_ga6125d0273c466e402db1a8f5bf888857}

\item 
\hypertarget{group___c_a_n_ga60a32132df242146efd3e9f7a079f0f0}{\#define {\bfseries I\-N\-A\-K\-\_\-\-T\-I\-M\-E\-O\-U\-T}~((uint32\-\_\-t)0x0000\-F\-F\-F\-F)}\label{group___c_a_n_ga60a32132df242146efd3e9f7a079f0f0}

\item 
\hypertarget{group___c_a_n_ga1bb8107706c8b4039ac55a122f3c65bb}{\#define {\bfseries S\-L\-A\-K\-\_\-\-T\-I\-M\-E\-O\-U\-T}~((uint32\-\_\-t)0x0000\-F\-F\-F\-F)}\label{group___c_a_n_ga1bb8107706c8b4039ac55a122f3c65bb}

\item 
\hypertarget{group___c_a_n_gac67e7d905ba11441bf9e14180805cf3a}{\#define {\bfseries C\-A\-N\-\_\-\-F\-L\-A\-G\-S\-\_\-\-T\-S\-R}~((uint32\-\_\-t)0x08000000)}\label{group___c_a_n_gac67e7d905ba11441bf9e14180805cf3a}

\item 
\hypertarget{group___c_a_n_ga2a03d73273ab353c8deb3a4730431977}{\#define {\bfseries C\-A\-N\-\_\-\-F\-L\-A\-G\-S\-\_\-\-R\-F1\-R}~((uint32\-\_\-t)0x04000000)}\label{group___c_a_n_ga2a03d73273ab353c8deb3a4730431977}

\item 
\hypertarget{group___c_a_n_ga4b22b2552759778ac07825240823a45f}{\#define {\bfseries C\-A\-N\-\_\-\-F\-L\-A\-G\-S\-\_\-\-R\-F0\-R}~((uint32\-\_\-t)0x02000000)}\label{group___c_a_n_ga4b22b2552759778ac07825240823a45f}

\item 
\hypertarget{group___c_a_n_ga3aaa7df395ce1a90cb6e2ff3d2c4b24e}{\#define {\bfseries C\-A\-N\-\_\-\-F\-L\-A\-G\-S\-\_\-\-M\-S\-R}~((uint32\-\_\-t)0x01000000)}\label{group___c_a_n_ga3aaa7df395ce1a90cb6e2ff3d2c4b24e}

\item 
\hypertarget{group___c_a_n_ga14f7bb0b320da21443c9bd60b1f86b5d}{\#define {\bfseries C\-A\-N\-\_\-\-F\-L\-A\-G\-S\-\_\-\-E\-S\-R}~((uint32\-\_\-t)0x00\-F00000)}\label{group___c_a_n_ga14f7bb0b320da21443c9bd60b1f86b5d}

\item 
\hypertarget{group___c_a_n_gaa62f09d0693681cb7576f61c93b7cf0f}{\#define {\bfseries C\-A\-N\-\_\-\-T\-X\-M\-A\-I\-L\-B\-O\-X\-\_\-0}~((uint8\-\_\-t)0x00)}\label{group___c_a_n_gaa62f09d0693681cb7576f61c93b7cf0f}

\item 
\hypertarget{group___c_a_n_ga4e20f0aac1ac940014a6c66971890943}{\#define {\bfseries C\-A\-N\-\_\-\-T\-X\-M\-A\-I\-L\-B\-O\-X\-\_\-1}~((uint8\-\_\-t)0x01)}\label{group___c_a_n_ga4e20f0aac1ac940014a6c66971890943}

\item 
\hypertarget{group___c_a_n_ga8a842aa352d72321930cc963b26bf6d7}{\#define {\bfseries C\-A\-N\-\_\-\-T\-X\-M\-A\-I\-L\-B\-O\-X\-\_\-2}~((uint8\-\_\-t)0x02)}\label{group___c_a_n_ga8a842aa352d72321930cc963b26bf6d7}

\item 
\hypertarget{group___c_a_n_ga79094ce5a3a2f717140e8cc9b7c161b6}{\#define {\bfseries C\-A\-N\-\_\-\-M\-O\-D\-E\-\_\-\-M\-A\-S\-K}~((uint32\-\_\-t) 0x00000003)}\label{group___c_a_n_ga79094ce5a3a2f717140e8cc9b7c161b6}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group___c_a_n___group1_ga002b74cd69574a14b17ad445090245cd}{C\-A\-N\-\_\-\-De\-Init} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Deinitializes the C\-A\-N peripheral registers to their default reset values. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group1_ga9023c35a9ab931ad4513fc5d19b4bd6c}{C\-A\-N\-\_\-\-Init} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, \hyperlink{struct_c_a_n___init_type_def}{C\-A\-N\-\_\-\-Init\-Type\-Def} $\ast$C\-A\-N\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Initializes the C\-A\-N peripheral according to the specified parameters in the C\-A\-N\-\_\-\-Init\-Struct. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group1_ga39476830280340363c51041be6b12647}{C\-A\-N\-\_\-\-Filter\-Init} (\hyperlink{struct_c_a_n___filter_init_type_def}{C\-A\-N\-\_\-\-Filter\-Init\-Type\-Def} $\ast$C\-A\-N\-\_\-\-Filter\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Configures the C\-A\-N reception filter according to the specified parameters in the C\-A\-N\-\_\-\-Filter\-Init\-Struct. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group1_gad77ad810868ed111755fc9e8ae0c7646}{C\-A\-N\-\_\-\-Struct\-Init} (\hyperlink{struct_c_a_n___init_type_def}{C\-A\-N\-\_\-\-Init\-Type\-Def} $\ast$C\-A\-N\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Fills each C\-A\-N\-\_\-\-Init\-Struct member with its default value. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group1_ga109ff8960bc59f44b984c9646f17b3c0}{C\-A\-N\-\_\-\-Slave\-Start\-Bank} (uint8\-\_\-t C\-A\-N\-\_\-\-Bank\-Number)
\begin{DoxyCompactList}\small\item\em Select the start bank filter for slave C\-A\-N. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group1_gac0e2d33e08caf49d1f1251f0dcc20213}{C\-A\-N\-\_\-\-D\-B\-G\-Freeze} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the D\-B\-G Freeze for C\-A\-N. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group1_ga94740177bab153ca5b102d122f9a8cca}{C\-A\-N\-\_\-\-T\-T\-Com\-Mode\-Cmd} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the C\-A\-N Time Trigger\-Operation communication mode. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group2_gaccfcb81f76f58400077c7b2d8641dd83}{C\-A\-N\-\_\-\-Transmit} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, \hyperlink{struct_can_tx_msg}{Can\-Tx\-Msg} $\ast$Tx\-Message)
\begin{DoxyCompactList}\small\item\em Initiates and transmits a C\-A\-N frame message. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group2_ga68ab05a0a6cdfcc2b6f6b6b2c10848e2}{C\-A\-N\-\_\-\-Transmit\-Status} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t Transmit\-Mailbox)
\begin{DoxyCompactList}\small\item\em Checks the transmission status of a C\-A\-N Frame. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group2_ga81106cdf5395a1947bfc87ec1685829e}{C\-A\-N\-\_\-\-Cancel\-Transmit} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t Mailbox)
\begin{DoxyCompactList}\small\item\em Cancels a transmit request. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group3_ga351b90bb8a3bb0c846f85bbd56ef4dc8}{C\-A\-N\-\_\-\-Receive} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t F\-I\-F\-O\-Number, \hyperlink{struct_can_rx_msg}{Can\-Rx\-Msg} $\ast$Rx\-Message)
\begin{DoxyCompactList}\small\item\em Receives a correct C\-A\-N frame. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group3_ga1bc3b39471e579b4101624c33d27918b}{C\-A\-N\-\_\-\-F\-I\-F\-O\-Release} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t F\-I\-F\-O\-Number)
\begin{DoxyCompactList}\small\item\em Releases the specified receive F\-I\-F\-O. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group3_ga7100459a95ce1b3cfe8ab15e112029fe}{C\-A\-N\-\_\-\-Message\-Pending} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t F\-I\-F\-O\-Number)
\begin{DoxyCompactList}\small\item\em Returns the number of pending received messages. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group4_gab2a3630e9e3024114eb117d14e514208}{C\-A\-N\-\_\-\-Operating\-Mode\-Request} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint8\-\_\-t C\-A\-N\-\_\-\-Operating\-Mode)
\begin{DoxyCompactList}\small\item\em Selects the C\-A\-N Operation mode. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group4_ga640215e38765759d7eceb8a039046667}{C\-A\-N\-\_\-\-Sleep} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Enters the Sleep (low power) mode. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group4_ga78cdfbf1884b9e33c552bcbca15bed10}{C\-A\-N\-\_\-\-Wake\-Up} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Wakes up the C\-A\-N peripheral from sleep mode . \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group5_gaaee721a392b6b21bfd15dc160aeb6924}{C\-A\-N\-\_\-\-Get\-Last\-Error\-Code} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\-A\-Nx's last error code (L\-E\-C). \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group5_ga6903eecbec40eb1361d915ddde9a3274}{C\-A\-N\-\_\-\-Get\-Receive\-Error\-Counter} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\-A\-Nx Receive Error Counter (R\-E\-C). \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group___c_a_n___group5_ga85ee0c35bf7ca15d4e4c862eef534843}{C\-A\-N\-\_\-\-Get\-L\-S\-B\-Transmit\-Error\-Counter} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx)
\begin{DoxyCompactList}\small\item\em Returns the L\-S\-B of the 9-\/bit C\-A\-Nx Transmit Error Counter(\-T\-E\-C). \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group6_gad1a8b2499a780b5bfa4accb3597b02f4}{C\-A\-N\-\_\-\-I\-T\-Config} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint32\-\_\-t C\-A\-N\-\_\-\-I\-T, Functional\-State New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables the specified C\-A\-Nx interrupts. \end{DoxyCompactList}\item 
Flag\-Status \hyperlink{group___c_a_n___group6_ga2faad96caf823ef463cc5b5b25c480bb}{C\-A\-N\-\_\-\-Get\-Flag\-Status} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint32\-\_\-t C\-A\-N\-\_\-\-F\-L\-A\-G)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\-A\-N flag is set or not. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group6_ga2c01646d5d3a2d7045e8dd71f58f8742}{C\-A\-N\-\_\-\-Clear\-Flag} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint32\-\_\-t C\-A\-N\-\_\-\-F\-L\-A\-G)
\begin{DoxyCompactList}\small\item\em Clears the C\-A\-N's pending flags. \end{DoxyCompactList}\item 
I\-T\-Status \hyperlink{group___c_a_n___group6_ga9aca05b3013e1b3438f3559f80b33c82}{C\-A\-N\-\_\-\-Get\-I\-T\-Status} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint32\-\_\-t C\-A\-N\-\_\-\-I\-T)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\-A\-Nx interrupt has occurred or not. \end{DoxyCompactList}\item 
void \hyperlink{group___c_a_n___group6_ga30bf7ac0c1793f6622a4a1adbb7dbc8a}{C\-A\-N\-\_\-\-Clear\-I\-T\-Pending\-Bit} (C\-A\-N\-\_\-\-Type\-Def $\ast$C\-A\-Nx, uint32\-\_\-t C\-A\-N\-\_\-\-I\-T)
\begin{DoxyCompactList}\small\item\em Clears the C\-A\-Nx's interrupt pending bits. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file provides firmware functions to manage the following functionalities of the Controller area network (C\-A\-N) peripheral\-: \begin{DoxyAuthor}{Author}
M\-C\-D Application Team 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
V1.\-0.\-0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
30-\/\-September-\/2011
\begin{DoxyItemize}
\item Initialization and Configuration
\item C\-A\-N Frames Transmission
\item C\-A\-N Frames Reception
\item Operation modes switch
\item Error management
\item Interrupts and flags
\end{DoxyItemize}
\end{DoxyDate}
\begin{DoxyVerb}*                               
*          ===================================================================      
*                                   How to use this driver
*          ===================================================================
              
*          1.  Enable the CAN controller interface clock using 
*                  RCC_APB1PeriphClockCmd(RCC_APB1Periph_CAN1, ENABLE); for CAN1 
*              and RCC_APB1PeriphClockCmd(RCC_APB1Periph_CAN2, ENABLE); for CAN2
*  @note   In case you are using CAN2 only, you have to enable the CAN1 clock.
*     
*          2. CAN pins configuration
*               - Enable the clock for the CAN GPIOs using the following function:
*                   RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOx, ENABLE);   
*               - Connect the involved CAN pins to AF9 using the following function 
*                   GPIO_PinAFConfig(GPIOx, GPIO_PinSourcex, GPIO_AF_CANx); 
*                - Configure these CAN pins in alternate function mode by calling
*                  the function  GPIO_Init();
*    
*          3.  Initialise and configure the CAN using CAN_Init() and 
*               CAN_FilterInit() functions.   
*               
*          4.  Transmit the desired CAN frame using CAN_Transmit() function.
*         
*          5.  Check the transmission of a CAN frame using CAN_TransmitStatus()
*              function.
*               
*          6.  Cancel the transmission of a CAN frame using CAN_CancelTransmit()
*              function.  
*            
*          7.  Receive a CAN frame using CAN_Recieve() function.
*         
*          8.  Release the receive FIFOs using CAN_FIFORelease() function.
*               
*          9. Return the number of pending received frames using 
*              CAN_MessagePending() function.            
*                   
*          10. To control CAN events you can use one of the following two methods:
*               - Check on CAN flags using the CAN_GetFlagStatus() function.  
*               - Use CAN interrupts through the function CAN_ITConfig() at 
*                 initialization phase and CAN_GetITStatus() function into 
*                 interrupt routines to check if the event has occurred or not.
*             After checking on a flag you should clear it using CAN_ClearFlag()
*             function. And after checking on an interrupt event you should 
*             clear it using CAN_ClearITPendingBit() function.            
*               
*              
*  \end{DoxyVerb}


\begin{DoxyAttention}{Attention}

\end{DoxyAttention}
T\-H\-E P\-R\-E\-S\-E\-N\-T F\-I\-R\-M\-W\-A\-R\-E W\-H\-I\-C\-H I\-S F\-O\-R G\-U\-I\-D\-A\-N\-C\-E O\-N\-L\-Y A\-I\-M\-S A\-T P\-R\-O\-V\-I\-D\-I\-N\-G C\-U\-S\-T\-O\-M\-E\-R\-S W\-I\-T\-H C\-O\-D\-I\-N\-G I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N R\-E\-G\-A\-R\-D\-I\-N\-G T\-H\-E\-I\-R P\-R\-O\-D\-U\-C\-T\-S I\-N O\-R\-D\-E\-R F\-O\-R T\-H\-E\-M T\-O S\-A\-V\-E T\-I\-M\-E. A\-S A R\-E\-S\-U\-L\-T, S\-T\-M\-I\-C\-R\-O\-E\-L\-E\-C\-T\-R\-O\-N\-I\-C\-S S\-H\-A\-L\-L N\-O\-T B\-E H\-E\-L\-D L\-I\-A\-B\-L\-E F\-O\-R A\-N\-Y D\-I\-R\-E\-C\-T, I\-N\-D\-I\-R\-E\-C\-T O\-R C\-O\-N\-S\-E\-Q\-U\-E\-N\-T\-I\-A\-L D\-A\-M\-A\-G\-E\-S W\-I\-T\-H R\-E\-S\-P\-E\-C\-T T\-O A\-N\-Y C\-L\-A\-I\-M\-S A\-R\-I\-S\-I\-N\-G F\-R\-O\-M T\-H\-E C\-O\-N\-T\-E\-N\-T O\-F S\-U\-C\-H F\-I\-R\-M\-W\-A\-R\-E A\-N\-D/\-O\-R T\-H\-E U\-S\-E M\-A\-D\-E B\-Y C\-U\-S\-T\-O\-M\-E\-R\-S O\-F T\-H\-E C\-O\-D\-I\-N\-G I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N C\-O\-N\-T\-A\-I\-N\-E\-D H\-E\-R\-E\-I\-N I\-N C\-O\-N\-N\-E\-C\-T\-I\-O\-N W\-I\-T\-H T\-H\-E\-I\-R P\-R\-O\-D\-U\-C\-T\-S.

\subsubsection*{\begin{center}\copyright C\-O\-P\-Y\-R\-I\-G\-H\-T 2011 S\-T\-Microelectronics\end{center} }

Definition in file \hyperlink{stm32f4xx__can_8c_source}{stm32f4xx\-\_\-can.\-c}.

